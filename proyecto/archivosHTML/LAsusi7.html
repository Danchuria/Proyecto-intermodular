<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tarjeta de Producto</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body onload="carrito()">
  <div class="card">
    <img id="imagen" src="../media/img/laptops/asus.webp" alt="Raton">
    <div class="card-content">
      <h2 id="nombreProducto">ASUS TUF Gaming i7</h2>
      <input type="text" id="precio" value="1379.00" readonly> ‚Ç¨
      <p class="description">Orientado a gaming de alto rendimiento. Procesador Intel Core i7, gr√°fica dedicada RTX. Chasis robusto, buena refrigeraci√≥n.</p>
      
      <div class="quantity">
        <button onclick="restar()">-</button>
        <input id="cantidad" type="number" value=1>
        <button onclick="sumar()">+</button>
      </div>

      <button id="btn-primary" class="btn-primary">A√±adir al carrito</button>

      <a href="index.html">
      <button class="btn-secondary">Seguir comprando</button>
      </a>
    </div>
  </div>
  <script>
    function carrito() 
    {
      // ‚úÖ Aseguramos que el elemento existe antes de a√±adir el listener
      const boton = document.getElementById("btn-primary");
      boton.addEventListener("click", function() {
        console.log("‚úÖ Entrada event Listener");

        // ‚úÖ Capturamos los datos del producto
        let datos = {
          idProducto: 1, 
          nombre: document.getElementById("nombreProducto").innerText,
          categoria: "Accesorios",
          cantidad: document.getElementById("cantidad").value,
          precio: document.getElementById("precio").value
        };

        console.log("üì¶ Enviando al backend:", datos);

        // ‚úÖ Enviamos con fetch
        fetch("http://localhost/proyecto/php/src/create_product.php", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(datos)
        })
        .then(response => response.text())
        .then(data => {
          console.log("Respuesta del backend:", data);
          alert("Producto a√±adido al carrito ‚úÖ");
        })
        .catch(error => console.error("Error:", error));
      });
    }
    
    function sumar()
    {
      let cantidad = document.getElementById("cantidad");
      cantidad.value++;    
    }
        
    function restar()
    {
      let cantidad = document.getElementById("cantidad");
      if(cantidad.value > 0)
      {
        cantidad.value--;
      }  
    }
    </script>
</body>
</html>